services:
    # facade service and wrapper for the repository services
    agit.localedata.provider:
        class: Agit\LocaleDataBundle\Service\ProviderService
        arguments: [ "@agit.localedata.currency", "@agit.localedata.country", "@agit.localedata.language", "@agit.localedata.timezone" ]

    # optional Twig extension for key-value-lists of localedata
    agit.localedata.twig:
        class: Agit\LocaleDataBundle\Service\LocaleDataExtension
        tags:
            - { name: twig.extension }
        arguments:  [ "@agit.localedata.provider", "@agit.intl.locale" ]

    #
    # repository services, to access single localedata repositories, if using
    # agit.localedata.provider is not desired
    #

    agit.localedata.currency:
        class: Doctrine\Common\Persistence\ObjectRepository
        factory_service: doctrine
        factory_method: getRepository
        arguments: [ AgitLocaleDataBundle:Currency ]

    agit.localedata.country:
        class: Doctrine\Common\Persistence\ObjectRepository
        factory_service: doctrine
        factory_method: getRepository
        arguments: [ AgitLocaleDataBundle:Country ]

    agit.localedata.language:
        class: Doctrine\Common\Persistence\ObjectRepository
        factory_service: doctrine
        factory_method: getRepository
        arguments: [ AgitLocaleDataBundle:Language ]

    agit.localedata.timezone:
        class: Doctrine\Common\Persistence\ObjectRepository
        factory_service: doctrine
        factory_method: getRepository
        arguments: [ AgitLocaleDataBundle:Timezone ]


    #
    # seed services to insert data into the DB
    #

    agit.localedata.seed.currency:
        private: true
        class: Agit\LocaleDataBundle\EventListener\CurrencySeed
        arguments: [ "@agit.intl.locale", "@agit.cldr.adapter.currency" ]
        tags: [{ name: kernel.event_listener, event: agit.seed, method: registerSeed }]

    agit.localedata.seed.country:
        private: true
        class: Agit\LocaleDataBundle\EventListener\CountrySeed
        arguments: [ "@agit.intl.locale", "@agit.cldr.adapter.country" ]
        tags: [{ name: kernel.event_listener, event: agit.seed, method: registerSeed }]

    agit.localedata.seed.language:
        private: true
        class: Agit\LocaleDataBundle\EventListener\LanguageSeed
        arguments: [ "@agit.intl.locale", "@agit.cldr.adapter.language" ]
        tags: [{ name: kernel.event_listener, event: agit.seed, method: registerSeed }]

    agit.localedata.seed.timezone:
        private: true
        class: Agit\LocaleDataBundle\EventListener\TimezoneSeed
        arguments: [ "@agit.intl.locale", "@agit.cldr.adapter.timezone" ]
        tags: [{ name: kernel.event_listener, event: agit.seed, method: registerSeed }]


    # settings (only loaded if setting-bundle is installed)

    agit.order.setting.currency:
        class: Agit\LocaleDataBundle\Setting\CurrencySetting
        arguments: [ "@agit.localedata.currency" ]
        tags: [{ name: agit.setting }]

    agit.order.setting.country:
        class: Agit\LocaleDataBundle\Setting\CountrySetting
        arguments: [ "@agit.localedata.country" ]
        tags: [{ name: agit.setting }]

    agit.order.setting.timezone:
        class: Agit\LocaleDataBundle\Setting\TimezoneSetting
        arguments: [ "@agit.localedata.timezone" ]
        tags: [{ name: agit.setting }]

    # registration listener for translation catalogs

    agit.localedata.catalog.register:
        class: Agit\LocaleDataBundle\EventListener\CldrCatalogListener
        arguments:
            - "@filesystem"
            - "@agit.intl.locale"
            - "@agit.cldr.adapter.currency"
            - "@agit.cldr.adapter.country"
            - "@agit.cldr.adapter.language"
            - "@agit.cldr.adapter.time"
            - "@agit.cldr.adapter.timezone"
        tags: [{ name: kernel.event_listener, event: agit.intl.global.translations, method: onRegistration }]
